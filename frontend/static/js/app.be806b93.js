(function(t){function e(e){for(var o,r,i=e[0],u=e[1],l=e[2],p=0,d=[];p<i.length;p++)r=i[p],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&d.push(s[r][0]),s[r]=0;for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(t[o]=u[o]);c&&c(e);while(d.length)d.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],o=!0,i=1;i<n.length;i++){var u=n[i];0!==s[u]&&(o=!1)}o&&(a.splice(e--,1),t=r(r.s=n[0]))}return t}var o={},s={app:0},a=[];function r(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=o,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var c=u;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"56d7":function(t,e,n){"use strict";n.r(e);n("caad"),n("45fc"),n("b0c0"),n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),s=n("5f5b"),a=(n("f9e3"),n("2dd8"),n("bc3a")),r=n.n(a),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n(t.layout,{tag:"component"},[n("router-view")],1)],1)},u=[],l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("router-view")],1)},c=[],p=n("2877"),d={},h=Object(p["a"])(d,l,c,!1,null,null,null),m=h.exports,f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("BNav"),n("router-view")],1)},g=[],b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-nav",{attrs:{align:"center"}},[n("b-nav-item",{attrs:{to:{name:"Account"}}},[t._v("My account")]),t.isAdmin?n("b-nav-item",{attrs:{to:{name:"Shops"}}},[t._v("Shops")]):t._e(),t.isAdmin?n("b-nav-item",{attrs:{to:{name:"Users"}}},[t._v("Users")]):t._e(),n("b-nav-item",{attrs:{to:{name:"Logout"}}},[t._v("Logout")])],1)],1)},v=[],_={computed:{isAdmin:function(){return this.$store.getters.isAdmin}}},y=_,w=Object(p["a"])(y,b,v,!1,null,null,null),k=w.exports,$={components:{BNav:k}},S=$,x=Object(p["a"])(S,f,g,!1,null,null,null),C=x.exports,A={components:{BlankLayout:m,MainLayout:C},computed:{layout:function(){return this.$route.meta.layout}}},O=A,j=(n("5c0b"),Object(p["a"])(O,i,u,!1,null,null,null)),T=j.exports,I=n("8c4f"),q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container w-50"},[n("h1",[t._v(" "+t._s(t.user.username)+" "),n("b-button",{staticClass:"ml-2",attrs:{type:"delete",variant:"danger"},on:{click:t.onDelete}},[t._v(" Delete account ")])],1),n("transition",{attrs:{name:"fade"}},[t.show?n("b-form",{attrs:{novalidate:"",validated:""},on:{submit:t.onSubmit}},[n("b-form-group",{attrs:{id:"input-group-first_name",label:"First name:","label-for":"input-first_name"}},[n("b-form-input",{attrs:{id:"input-first_name",required:""},on:{input:t.toogleChanged},model:{value:t.user.first_name,callback:function(e){t.$set(t.user,"first_name",e)},expression:"user.first_name"}})],1),n("b-form-group",{attrs:{id:"input-group-last_name",label:"Last name:","label-for":"input-last_name"}},[n("b-form-input",{attrs:{id:"input-last_name",required:""},on:{input:t.toogleChanged},model:{value:t.user.last_name,callback:function(e){t.$set(t.user,"last_name",e)},expression:"user.last_name"}})],1),n("b-form-group",{attrs:{id:"input-group-shop",label:"Shop:","label-for":"input-shop"}},[n("b-form-select",{attrs:{id:"input-shop",options:t.shops,"value-field":"id","text-field":"name",required:""},on:{change:t.toogleChanged},model:{value:t.user.shop.id,callback:function(e){t.$set(t.user.shop,"id",e)},expression:"user.shop.id"}})],1),t.changed?n("div",[n("b-button",{staticClass:"mr-2",attrs:{type:"submit",variant:"primary"}},[t._v("Update")])],1):n("div",[n("p",[t._v("Enter or change your data!")])])],1):t._e()],1)],1)},D=[],E={data:function(){return{user:{id:"",username:"",first_name:"",last_name:"",shop:{}},shops:[],show:!1,changed:!1,message:"",errors:[]}},mounted:function(){var t=this;r.a.get("api/user/"+this.$store.state.userId).then((function(e){t.user=e.data,t.user.shop||(t.user.shop={id:null}),t.show=!0})).catch((function(t){console.log(t)})),r.a.get("api/list_shops").then((function(e){t.shops=e.data})).catch((function(t){console.log(t)}))},methods:{toogleChanged:function(t){this.changed=!0},onSubmit:function(t){var e=this;t.preventDefault(),this.user.first_name&&this.user.last_name&&this.user.shop.id&&(this.user.shop_id=this.user.shop.id,r.a.put("api/user/"+this.$store.state.userId+"/",this.user).then((function(){e.$router.push({name:"Account"}),e.changed=!1})).catch((function(t){console.log(t)})))},onDelete:function(t){var e=this;t.preventDefault(),r.a.delete("api/user/"+this.$store.state.userId+"/").then((function(){return e.$store.dispatch("logout")})).then((function(){return e.$router.push("/login")})).catch((function(t){console.log(t)}))}}},U=E,L=Object(p["a"])(U,q,D,!1,null,null,null),P=L.exports,B=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("h1",[t._v(" Shops "),n("router-link",{attrs:{to:"/shops/create"}},[n("AddButton")],1)],1),n("transition",{attrs:{name:"fade"}},[t.loading?t._e():n("b-table",{attrs:{responsive:"",fields:t.fields,items:t.shops,"caption-top":""},scopedSlots:t._u([{key:"table-caption",fn:function(){return[t._v("Click on a shop name to edit the Shop. Click on an owner to edit the User. ")]},proxy:!0},{key:"cell(name)",fn:function(e){return[n("router-link",{attrs:{to:"/shops/"+e.item.id}},[t._v(" "+t._s(e.item.name)+" ")])]}},{key:"cell(owner)",fn:function(e){return[n("router-link",{attrs:{to:"/users/"+e.item.owner.id}},[t._v(" "+t._s(e.item.owner.username)+" ")])]}}],null,!1,1876875611)})],1)],1)},M=[],z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-button",{staticClass:"mb-2",attrs:{type:"button",variant:"outline-primary"}},[t._v(" Add ")])},N=[],F={},J=Object(p["a"])(F,z,N,!1,null,null,null),R=J.exports,G={components:{AddButton:R},data:function(){return{shops:[],fields:[{key:"id",sortable:!0},{key:"name",sortable:!0},{key:"owner",sortable:!0}],loading:!0}},created:function(){var t=this;this.$http.get("api/shop/").then((function(e){t.shops=e.data,t.loading=!1})).catch((function(t){console.log(t)}))}},H=G,K=Object(p["a"])(H,B,M,!1,null,null,null),Q=K.exports,V=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("h1",[t._v(" Users "),n("router-link",{attrs:{to:"/users/create"}},[n("AddButton")],1)],1),n("transition",{attrs:{name:"fade"}},[t.loading?t._e():n("b-table",{attrs:{responsive:"",fields:t.fields,items:t.users,"caption-top":""},scopedSlots:t._u([{key:"table-caption",fn:function(){return[t._v("Click on a username to edit the User. Click on a shop name to edit the Shop.")]},proxy:!0},{key:"cell(username)",fn:function(e){return[n("router-link",{attrs:{to:"/users/"+e.item.id}},[t._v(" "+t._s(e.item.username)+" ")])]}},{key:"cell(shop)",fn:function(e){return[e.item.shop?n("router-link",{attrs:{to:"/shops/"+e.item.shop.id}},[t._v(" "+t._s(e.item.shop.name)+" ")]):t._e()]}}],null,!1,2333506408)})],1)],1)},W=[],X={components:{AddButton:R},data:function(){return{users:[],fields:[{key:"id",sortable:!0},{key:"username",sortable:!0},{key:"shop",sortable:!0}],loading:!0}},created:function(){var t=this;this.$http.get("api/user/").then((function(e){t.users=e.data,t.loading=!1})).catch((function(t){console.log(t)}))}},Y=X,Z=Object(p["a"])(Y,V,W,!1,null,null,null),tt=Z.exports,et=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container w-50"},[n("h1",[t._v(" "+t._s(t.shop.name)+" "),t.shop.id?n("b-button",{staticClass:"ml-2",attrs:{type:"delete",variant:"outline-danger"},on:{click:t.onDelete}},[t._v(" Delete ")]):t._e()],1),n("transition",{attrs:{name:"fade"}},[t.show?n("b-form",{attrs:{novalidate:"",validated:""},on:{submit:t.onSubmit}},[n("b-form-group",{attrs:{id:"input-group-name",label:"Name:","label-for":"input-name"}},[n("b-form-input",{attrs:{id:"input-name",required:""},on:{input:t.toogleChanged},model:{value:t.shop.name,callback:function(e){t.$set(t.shop,"name",e)},expression:"shop.name"}})],1),n("b-form-group",{attrs:{id:"input-group-owner",label:"Owner:","label-for":"input-owner"}},[n("b-form-select",{attrs:{id:"input-owner",options:t.users,"value-field":"id","text-field":"username",required:""},on:{change:t.toogleChanged},model:{value:t.shop.owner.id,callback:function(e){t.$set(t.shop.owner,"id",e)},expression:"shop.owner.id"}})],1),t.changed?n("div",[t.shop.id?n("b-button",{staticClass:"mr-2",attrs:{type:"submit",variant:"primary"}},[t._v("Update")]):n("b-button",{attrs:{type:"submit",variant:"success"}},[t._v("Create")])],1):n("div",[n("p",[t._v("Enter or change Shop data!")])])],1):t._e()],1)],1)},nt=[],ot={data:function(){return{shop:{id:"",name:"",owner:{}},users:[],show:!1,changed:!1,errors:[]}},mounted:function(){var t=this;parseInt(this.$route.params.id,10)?this.$http.get("api/shop/"+this.$route.params.id).then((function(e){t.shop=e.data,t.show=!0})).catch((function(t){console.log(t)})):this.show=!0,this.$http.get("api/list_users").then((function(e){t.users=e.data})).catch((function(t){console.log(t)}))},methods:{toogleChanged:function(t){this.changed=!0},onSubmit:function(t){var e=this;t.preventDefault(),this.shop.name&&this.shop.owner.id&&(this.shop.owner_id=this.shop.owner.id,this.shop.id?this.$http.put("api/shop/"+this.$route.params.id+"/",this.shop).then((function(){e.$router.push({name:"Shops"}),e.changed=!1})).catch((function(t){console.log(t)})):this.$http.post("api/shop/",this.shop).then((function(){e.$router.push({name:"Shops"}),e.changed=!1})).catch((function(t){console.log(t)})))},onDelete:function(t){var e=this;t.preventDefault(),r.a.delete("api/shop/"+this.shop.id+"/").then((function(){return e.$router.push("/shops")})).catch((function(t){console.log(t)}))}}},st=ot,at=Object(p["a"])(st,et,nt,!1,null,null,null),rt=at.exports,it=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container w-50"},[n("h1",[t._v(" "+t._s(t.user.username)+" "),t.user.id?n("b-button",{staticClass:"ml-2",attrs:{type:"delete",variant:"danger"},on:{click:t.onDelete}},[t._v(" Delete ")]):t._e()],1),n("transition",{attrs:{name:"fade"}},[t.show?n("b-form",{attrs:{novalidate:"",validated:""},on:{submit:t.onSubmit}},[n("b-form-group",{attrs:{id:"input-group-first_name",label:"First name:","label-for":"input-first_name"}},[n("b-form-input",{attrs:{id:"input-first_name",required:""},on:{input:t.toogleChanged},model:{value:t.user.first_name,callback:function(e){t.$set(t.user,"first_name",e)},expression:"user.first_name"}})],1),n("b-form-group",{attrs:{id:"input-group-last_name",label:"Last name:","label-for":"input-last_name"}},[n("b-form-input",{attrs:{id:"input-last_name",required:""},on:{input:t.toogleChanged},model:{value:t.user.last_name,callback:function(e){t.$set(t.user,"last_name",e)},expression:"user.last_name"}})],1),n("b-form-group",{attrs:{id:"input-group-shop",label:"Shop:","label-for":"input-shop"}},[n("b-form-select",{attrs:{id:"input-shop",options:t.shops,"value-field":"id","text-field":"name",required:""},on:{change:t.toogleChanged},model:{value:t.user.shop.id,callback:function(e){t.$set(t.user.shop,"id",e)},expression:"user.shop.id"}})],1),t.changed?n("div",[t.user.id?n("b-button",{staticClass:"mr-2",attrs:{type:"submit",variant:"primary"}},[t._v("Update")]):n("b-button",{attrs:{type:"submit",variant:"success"}},[t._v("Create")])],1):n("div",[n("p",[t._v("Enter or change User data!")])])],1):t._e()],1)],1)},ut=[],lt={data:function(){return{user:{id:"",username:"",first_name:"",last_name:"",shop:{}},shops:[],show:!1,changed:!1,errors:[]}},mounted:function(){var t=this;parseInt(this.$route.params.id,10)?r.a.get("api/user/"+this.$route.params.id).then((function(e){t.user=e.data,t.user.shop||(t.user.shop={id:null}),t.show=!0})).catch((function(t){console.log(t)})):this.show=!0,r.a.get("api/list_shops").then((function(e){t.shops=e.data})).catch((function(t){console.log(t)}))},methods:{toogleChanged:function(t){this.changed=!0},onSubmit:function(t){var e=this;t.preventDefault(),this.user.first_name&&this.user.last_name&&this.user.shop.id&&(this.user.shop_id=this.user.shop.id,this.user.id?r.a.put("api/user/"+this.$route.params.id+"/",this.user).then((function(){e.$router.push({name:"Users"}),e.changed=!1})).catch((function(t){console.log(t)})):r.a.post("api/user/",this.user).then((function(){e.$router.push({name:"Users"}),e.changed=!1})).catch((function(t){console.log(t)})))},onDelete:function(t){var e=this;t.preventDefault(),this.user.id===this.$store.state.userId?r.a.delete("api/user/"+this.user.id+"/").then((function(){return e.$store.dispatch("logout")})).then((function(){return e.$router.push("/login")})).catch((function(t){console.log(t)})):r.a.delete("api/user/"+this.user.id+"/").catch((function(t){console.log(t)}))}}},ct=lt,pt=Object(p["a"])(ct,it,ut,!1,null,null,null),dt=pt.exports,ht=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container d-flex justify-content-center"},[n("b-card",{staticStyle:{"max-width":"20rem"},attrs:{title:"Login"}},[n("b-form",{attrs:{novalidate:"",validated:""},on:{submit:t.onSubmit}},[n("b-form-group",{attrs:{id:"input-group-username",label:"Username:","label-for":"input-username"}},[n("b-form-input",{attrs:{id:"input-username",required:""},on:{input:t.showSubmitButton},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}})],1),n("b-form-group",{attrs:{id:"input-group-password",label:"Password:","label-for":"input-password",type:"password"}},[n("b-form-input",{attrs:{id:"input-password",required:""},on:{input:t.showSubmitButton},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),n("transition",{attrs:{name:"fade"}},[t.show?n("b-button",{staticClass:"mr-2",attrs:{type:"submit",variant:"success"}},[t._v("Login")]):t._e()],1)],1)],1)],1)},mt=[],ft={data:function(){return{username:null,password:null,show:null}},methods:{showSubmitButton:function(t){this.username&&this.password?this.show=!0:this.show=null},onSubmit:function(t){var e=this;t.preventDefault(),this.$store.dispatch("getToken",{username:this.username,password:this.password}).then((function(){return e.$router.push("/account")})).catch((function(t){return alert("Please, check your login/password!")}))}}},gt=ft,bt=Object(p["a"])(gt,ht,mt,!1,null,null,null),vt=bt.exports,_t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},yt=[],wt={created:function(){var t=this;this.$store.dispatch("deleteToken").then((function(){return t.$router.push("/login")})).catch((function(t){return console.log(t)}))}},kt=wt,$t=Object(p["a"])(kt,_t,yt,!1,null,null,null),St=$t.exports;o["default"].use(I["a"]);var xt=[{path:"/account",name:"Account",component:P,meta:{layout:"main-layout",requiresAdmin:null}},{path:"/shops",name:"Shops",component:Q,meta:{layout:"main-layout",requiresAdmin:!0}},{path:"/users",name:"Users",component:tt,meta:{layout:"main-layout",requiresAdmin:!0}},{path:"/shops/:id",name:"Shop",component:rt,meta:{layout:"main-layout",requiresAdmin:!0}},{path:"/users/:id",name:"User",component:dt,meta:{layout:"main-layout"}},{path:"/login",name:"Login",component:vt,meta:{layout:"blank-layout",requiresAdmin:null}},{path:"/logout",name:"Logout",component:St,meta:{layout:"blank-layout",requiresAdmin:null}}],Ct=new I["a"]({mode:"history",base:"/",routes:xt}),At=Ct,Ot=(n("d3b7"),n("2f62"));o["default"].use(Ot["a"]),r.a.defaults.baseURL="/";var jt=new Ot["a"].Store({state:{token:localStorage.getItem("token")||"",userId:"",userType:""},mutations:{getToken:function(t,e){t.token=e.token,t.userId=e.userId,t.userType=e.userType},deleteToken:function(t){t.token="",t.userType=""}},actions:{getToken:function(t,e){var n=t.commit;return new Promise((function(t,o){r.a.post("http://localhost:8000/api/get_token",{username:e.username,password:e.password}).then((function(e){console.log(e.data);var o=e.data.token,s=e.data.id,a=e.data.user_type;localStorage.setItem("token",o),n("getToken",{token:o,userType:a,userId:s}),r.a.defaults.headers.common.Authorization="Token "+o,t(e)})).catch((function(t){console.log(t),o(t)}))}))},deleteToken:function(t){if(t.getters.loggedIn)return new Promise((function(e,n){r.a.post("http://localhost:8000/api/delete_token").then((function(n){delete r.a.defaults.headers.common.Authorization,localStorage.removeItem("token"),t.commit("deleteToken"),e(n)})).catch((function(t){console.log(t),n(t)}))}))},logout:function(t){t.getters.loggedIn&&(delete r.a.defaults.headers.common.Authorization,localStorage.removeItem("token"),t.commit("deleteToken"))}},modules:{},getters:{loggedIn:function(t){return!!t.token||null},isAdmin:function(t){return 1===t.userType||null}}});o["default"].config.productionTip=!1,o["default"].use(s["a"]),o["default"].prototype.$http=r.a;var Tt=localStorage.getItem("token");Tt&&(o["default"].prototype.$http.defaults.headers.common.Authorization="Token "+Tt),At.beforeEach((function(t,e,n){["Login","Signup"].includes(t.name)||jt.getters.loggedIn?t.matched.some((function(t){return t.meta.requiresAdmin}))&&!jt.getters.isAdmin?n({name:"Account"}):n():n({name:"Login"})})),new o["default"]({router:At,store:jt,render:function(t){return t(T)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var o=n("9c0c"),s=n.n(o);s.a},"9c0c":function(t,e,n){}});
//# sourceMappingURL=app.be806b93.js.map